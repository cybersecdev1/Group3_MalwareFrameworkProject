#from AttachmentClass import Attachment
from send import send_email

class RiskParameters:
	def __init__(self, attachment):
		self.attachment = attachment
		self.baseline = {
			'ole_format': True,
			'has_suminfo': True,
			'appname': None,
			'encrypted': False,
			'word': None,
			'vba_macros': False,
			'excel': None,
			'ppt': None,
			'visio': None,
			'ObjectPool': False,
			'flash': 0,
		}

		self.categories = {
			'low': 0,
			'medium': 1,
			'high': 5
		}

	def get_baseline(self):
		print('~~~~~~~~~~~~~~~~~~~printing baseline~~~~~~~~~~~~~~~~~~~~~~')
		return [ print(f'{key}: {value}') for key, value in self.baseline.items()]

	def get_parameter(self):
		print('~~~~~~~~~~~~~~~~~~~printing parameters~~~~~~~~~~~~~~~~~~~~~~')
		return [ print(f'{key}: {value}') for key, value in self.attachment_parameters.items()]

	def compare_with_baseline(self):
		risk_score = 0
		for i in self.attachment.indicators:
			if i.id in ['encrypted', 'has_suminfo', 'vba_macros', 'flash', 'ObjectPool']:
				if i.value != self.baseline[i.id]:
					risk_score+=1
		
		if risk_score == self.categories['low']:
			print("This file has low risk category")
			print("-------------------------------")
		elif risk_score >= self.categories['medium'] and risk_score < self.categories['high']:
			print("This file has medium risk category")
			send_email("userone", "administrator")
			print("-------------------------------")
		elif risk_score >= self.categories['high']:
			print("This file has high risk category")
			send_email("userone", "administrator")
			print("-------------------------------")



