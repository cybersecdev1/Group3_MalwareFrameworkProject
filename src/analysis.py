import oletools.oleid
from oletools.olevba import VBA_Parser, TYPE_OLE, TYPE_OpenXML, TYPE_Word2003_XML, TYPE_MHTML
from tabulate import tabulate
from Indicator import Indicator
	
def full_analysis(path):
	oid = oletools.oleid.OleID(path)
	indicators = oid.check()
	file_name=path[path.rindex('\\')+1:]
	print(f"OLE Analysis for {file_name}")
	parsed_indicators = [ Indicator(file_name, i.id, i.name, i.value).item() for i in indicators ]
	print(tabulate(parsed_indicators), end='\n\n\n')
	analyze_vba(path)

def analyze_vba(filepath):
	vbaparser = VBA_Parser(filepath)
	filedata = open(filepath, 'rb').read()
	vbaparser = VBA_Parser(filepath, data=filedata)
	if vbaparser.type == 'OpenXML':
		if vbaparser.detect_vba_macros():
			print('VBA Macros found')
		else:
			print('No VBA Macros found')

