import oletools.oleid
from oletools.olevba import VBA_Parser, TYPE_OLE, TYPE_OpenXML, TYPE_Word2003_XML, TYPE_MHTML
from tabulate import tabulate
from AttachmentClass import Attachment
from parameters import RiskParameters
	
def full_analysis(path):
	oid = oletools.oleid.OleID(path)
	indicators = oid.check()
	file_name=path[path.rindex('\\')+1:]
	print(f"OLE Analysis for {file_name}")
	attachment = Attachment(file_name, indicators)
	parameter = RiskParameters(attachment)
	parameter.compare_with_baseline()
	analyze_vba(path)

def analyze_vba(filepath):
	vbaparser = VBA_Parser(filepath)
	filedata = open(filepath, 'rb').read()
	vbaparser = VBA_Parser(filepath, data=filedata)
	if vbaparser.type == 'OpenXML':
		if vbaparser.detect_vba_macros():
			print('VBA Macros found')
		else:
			print('No VBA Macros found')

