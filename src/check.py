from exchangelib import Account, Message, Mailbox, FileAttachment, HTMLBody, DELEGATE, Credentials, Configuration, ItemAttachment
from exchangelib.protocol import BaseProtocol, NoVerifyHTTPAdapter
import urllib3

def check_email():
	user_name=input("Enter user account name: ")
	check_dir=input("Check folder (inbox/sent): ")
	if 'user' in user_name:
		password = 'Junk@6204'
	else:
		password = 'Passw0rd!'
	urllib3.disable_warnings()
	BaseProtocol.HTTP_ADAPTER_CLS = NoVerifyHTTPAdapter
	cred = Credentials(username='groupthree\\{}'.format(user_name), password=password)
	config = Configuration(server='mail.groupthree.local', credentials=cred)
	user_account = Account(primary_smtp_address='{}@groupthree.local'.format(user_name), credentials=cred, autodiscover=False, config=config, access_type=DELEGATE)
	print(f'All emails in {check_dir} of {user_name}')
	print()
	if check_dir == "inbox":
		[print(mail.subject) for mail in user_account.inbox.all()]
	elif check_dir == "sent":
		[print(mail.subject) for mail in user_account.sent.all()]
	else:
		print("Wrong choice")